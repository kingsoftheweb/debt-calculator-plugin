var dcmShortcodes={debtCalculator:{elements:{singleTabs:document.querySelectorAll(".single-grid-tab"),contentTabs:document.querySelectorAll(".arm_account_detail_tab.arm_account_detail_tab_content"),resultsTabs:document.querySelectorAll("td.arm-form-table-content.tab-has-result .title"),totalDebtInfo:document.querySelector(".total-debts-chart__main"),allDebtsInfo:document.querySelector(".total-debts-chart__main.all_debts"),monthlyLogs:document.querySelectorAll(".multi-graphics-wrapper input.order_logs_per_month"),addNewButton:document.querySelector(".dcm-shortcode input.submit.add-new-debt"),updateButtons:document.querySelectorAll(".dcm-shortcode input.submit.update-debt"),exportPDFs:document.querySelectorAll(".results-tab a.export-pdf")},events:function(){var t=dcmShortcodes.debtCalculator;window.onload=function(){t.functions.parseUrl(),t.functions.reportsCharts()},t.elements.singleTabs.forEach((function(e){e.addEventListener("click",(function(){var a=e.getAttribute("data-id");t.functions.showTab(a),t.functions.updateUrl(a)}))})),t.elements.resultsTabs.forEach((function(e){e.addEventListener("click",(function(){e.parentElement.classList.contains("open")?e.parentElement.classList.remove("open"):(t.elements.resultsTabs.forEach((function(t){t.parentElement.classList.remove("open")})),e.parentElement.classList.add("open"))}))})),t.elements.addNewButton.addEventListener("click",(function(){t.functions.addNewDebt(t.elements.addNewButton)})),t.elements.updateButtons.forEach((function(e){e.addEventListener("click",(function(){t.functions.updateDebt(e)}))})),t.elements.exportPDFs.forEach((function(t){t.addEventListener("click",(function(){var e=t.getAttribute("data-href"),a=document.querySelector('.reports-graphics[data-id="'+t.getAttribute("data-id")+'"]').innerHTML;dcpExportHTML.functions.pdfExport(a,e)}))}))},functions:{showTab:function(t){dcmShortcodes.debtCalculator.elements.singleTabs.forEach((function(t){t.classList.remove("active")})),document.querySelector('.single-grid-tab[data-id="'+t+'"]').classList.add("active"),dcmShortcodes.debtCalculator.elements.contentTabs.forEach((function(t){t.classList.remove("active")})),document.querySelector('.arm_account_detail_tab.arm_account_detail_tab_content[data-tab="'+t+'"]').classList.add("active");var e=parseInt(document.querySelector(".arm-tabs.dcm-wrapper.dcm-shortcode").offsetHeight)+parseInt(document.querySelector(".arm-tabs.dcm-wrapper.dcm-shortcode").offsetTop);window.scrollTo({top:e,left:0,behavior:"smooth"})},parseUrl:function(){var t=new URL(location.href),e=t.searchParams.get("tab"),a=t.searchParams.get("debt_id");return null!==e?(dcmShortcodes.debtCalculator.functions.showTab(e),a):null},updateUrl:function(t){var e=new URL(location.href);return history.pushState(null,"",e.pathname+"?tab="+t),e.pathname+"?tab="+t},reportsCharts:function(){document.querySelectorAll("canvas.debts-reports.line-chart").forEach((function(t){}));var t=dcmShortcodes.debtCalculator.elements.totalDebtInfo.querySelector('input[name="total_debts_info"]').value,e=dcmShortcodes.debtCalculator.elements.totalDebtInfo.querySelector("canvas.total-debts-canvas");createChart.functions.drawChart(e,e.getAttribute("data-id"),"doughnut",t);var a=dcmShortcodes.debtCalculator.elements.allDebtsInfo.querySelector('input[name="total_debts_info"]').value,n=dcmShortcodes.debtCalculator.elements.allDebtsInfo.querySelector('input[name="total_debts_info_labels"]').value,r=dcmShortcodes.debtCalculator.elements.allDebtsInfo.querySelector("canvas.total-debts-canvas");createChart.functions.drawDoughnutCombined(r,JSON.parse(a),JSON.parse(n)),dcmShortcodes.debtCalculator.elements.monthlyLogs.forEach((function(t){var e=JSON.parse(t.value),a=t.getAttribute("data-id");e.forEach((function(n,r){var o=n.start_date,c=n.end_date,l=0===r?"":'<i class="fa fa-arrow-left arrow-direction"></i>',d=r===e.length-1?"":'<i class="fa fa-arrow-right arrow-direction"></i>',s=r===e.length-1?"show":"hide",i=document.createElement("div");i.classList.add("single-month-chart",s),i.setAttribute("data-index",r),i.insertAdjacentHTML("afterbegin",'<div class="monthly-header" data-index = "'+r+'"><span class="arrow" data-direction ="back" data-index = "'+r+'">'+l+'</span><span class="start-date">'+o+'</span><span class="middle-icon">-</span><span class="end-date">'+c+'</span><span class="arrow" data-direction ="forward" data-index = "'+r+'">'+d+"</span></div>"),t.insertAdjacentElement("afterend",i),i.querySelectorAll(".monthly-header .arrow i").forEach((function(t){t.addEventListener("click",(function(){console.log(t);var e=t.parentElement.getAttribute("data-index"),a=0;switch(t.parentElement.getAttribute("data-direction")){case"forward":a=parseInt(e)+1;break;case"back":a=parseInt(e)-1}console.log(e,a),document.querySelectorAll(".single-month-chart").forEach((function(t){t.classList.remove("show")})),document.querySelector('.single-month-chart[data-index="'+a+'"]').classList.add("show")}))}));var u=document.createElement("canvas");u.classList.add("total-logs-per-month","line-chart"),u.setAttribute("debt-id",a),u.setAttribute("data-start_date",o),u.setAttribute("data-end_date",c),i.insertAdjacentElement("beforeend",u),createChart.functions.drawChart(u,a,"line",debtValuesJson=null,n);var m=document.createElement("canvas");m.classList.add("total-logs-per-month","line-chart"),m.setAttribute("debt-id",a),m.setAttribute("data-start_date",o),m.setAttribute("data-end_date",c),i.insertAdjacentElement("beforeend",m),createChart.functions.drawChart(m,a,"doughnut",debtValuesJson=null,n)}))})),document.querySelectorAll("canvas.debts-reports.doughnut-chart").forEach((function(t){createChart.functions.drawChart(t,t.getAttribute("data-id"),"doughnut")}))},addNewDebt:function(t){var e=t.parentElement.parentElement.parentElement.querySelector('input[name="author_id"]').value,a=t.parentElement.parentElement.parentElement.querySelector('input[name="debt_name"]'),n=t.parentElement.parentElement.querySelector('input[name="debt_amount"]'),r=t.parentElement.parentElement.querySelector('input[name="yearly_interest"]');""===a.value||""===n.value||""===r.value?alert("Fill All Fields please."):jQuery.post(dcp_object.ajaxurl,{action:"add_dcp_debt",debt_title:a.value,debt_amount:n.value,yearly_interest:r.value,author_id:e},(function(t){var e=dcmShortcodes.debtCalculator.functions.updateUrl("debts-reports&debt_id="+t);location.href=e}))},updateDebt:function(t){var e=t.parentElement.parentElement.querySelector('input[name="debt_id"]').value,a=t.parentElement.parentElement.querySelector('input[name="pay_amount"]'),n=t.parentElement.parentElement.querySelector('input[name="remaining"]').value,r=t.parentElement.parentElement.querySelector('input[name="interest"]').value;""===a?alert("Fill the Amount Field please."):jQuery.post(dcp_object.ajaxurl,{action:"update_dcp_debt",debtID:e,paid:a.value,remaining:n,interest:r},(function(t){var e=dcmShortcodes.debtCalculator.functions.updateUrl("debts-reports&debt_id="+t);location.href=e}))}},init:function(){dcmShortcodes.debtCalculator.events()}}};window.addEventListener("DOMContentLoaded",(function(t){dcmShortcodes.debtCalculator.init()}));